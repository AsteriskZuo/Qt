<sqls>
    <!-- TimeTableItem -->
    <prefix name="selectTimeTableItemPrefix">
        SELECT
        tti.id          as id,
        tti.clazz_id    as clazz_id,
        tti.course_id   as course_id,
        tti.teacher_id  as teacher_id,
        clazz.name      as clazz_name,
        course.name     as course_name,
        teacher.name    as teacher_name,
        tti.row         as row,
        tti.col         as col,
        tti.editable    as editable
        FROM time_table_item as tti, clazz, course, teacher
        WHERE tti.clazz_id=clazz.id AND tti.course_id=course.id AND tti.teacher_id=teacher.id
    </prefix>

    <sql name="findTimeTableItemById" prefix="selectTimeTableItemPrefix">
        AND tti.id=%1
    </sql>

    <sql name="findTimeTableItemByClazzId" prefix="selectTimeTableItemPrefix">
        AND tti.clazz_id=%1
    </sql>

    <sql name="findTimeTableItemByTeacherId" prefix="selectTimeTableItemPrefix">
        AND tti.teacher_id=%1
    </sql>

    <sql name="otherTimeTableItemCountAtTheSameTime"><![CDATA[
        SELECT count(1) FROM time_table_item
        WHERE row=:row
        AND col=:col
        AND teacher_id=:teacherId
        AND clazz_id<>:clazzId
    ]]></sql>

    <sql name="insertTimeTableItem">
        INSERT INTO time_table_item (clazz_id, course_id, teacher_id, row, col, editable)
        VALUES (:clazzId, :courseId, :teacherId, :row, :col, :editable)
    </sql>

    <sql name="updateTimeTableItem">
        UPDATE time_table_item SET
        clazz_id=:clazzId, course_id=:courseId, teacher_id=:teacherId,
        row=:row, col=:col, editable=:editable
        WHERE id=:id
    </sql>

    <sql name="removeTimeTableItemById">
        DDELETE FROM time_table_item WHERE id=%1
    </sql>

    <sql name="removeTimeTableItemByClazzId">
        DELETE FROM time_table_item WHERE clazz_id=%1
    </sql>

    <sql name="removeTimeTableItemByTeacherId">
        DELETE FROM time_table_item WHERE teacher_id=%1
    </sql>

    <!-- Clazz -->
    <sql name="findAllClazzes">
        SELECT id, name FROM clazz
    </sql>
    <sql name="findClazzById">
        SELECT id, name FROM clazz WHERE id=%1
    </sql>

    <!-- Course -->
    <sql name="findAllCourses">
        SELECT id, name FROM course
    </sql>

    <!-- Teacher -->
    <sql name="findAllTeachers">
        SELECT id, name FROM teacher
    </sql>
    <sql name="findTeacherById">
        SELECT id, name FROM teacher WHERE id=%1
    </sql>
</sqls>